<!DOCTYPE html>
<html>
<head>
    <title>Tree Height vs. Trunk Diameter</title>
    <!-- Load Plotly.js library -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Changed to column to allow content to flow naturally */
            /* Removed justify-content to remove extra space */
            min-height: 100vh;
            margin: 0;
            padding: 0; /* Removed padding to crop extra space */
            /* Default styles will be overwritten by JS for theme detection */
            transition: background-color 0.3s, color 0.3s;
        }
        .graph-container {
            width: 100%;
            max-width: 800px;
            margin-bottom: 0; /* Removed bottom margin */
        }
        #myDiv, #myDiv2 {
            width: 100%;
            height: 400px;
            border-radius: 0; /* Removed border-radius */
            overflow: hidden;
            box-shadow: none; /* Removed box-shadow */
        }
        h1, h2 {
            margin-bottom: 20px;
            text-align: center; /* Centered headings for better layout */
        }
        /* Style for the container to hold both headings and graphs */
        .main-container {
            padding: 20px;
            max-width: 800px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h2>Tree Height vs. Trunk Diameter</h2>
        <div class="graph-container">
            <!-- This is the div for the first plot -->
            <div id="myDiv"></div>
        </div>

        <div class="graph-container">
            <!-- This is the div for the second, centered plot -->
            <div id="myDiv2"></div>
        </div>
    </div>

    <script>
        // Sample data for trunk diameter and height
        const trunk_diameter_cm = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0];
        const height_m = [ 3, 5, 9, 11, 14, 16, 18, ];

        // Function to determine the theme colors
        const getThemeColors = () => {
            const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (isDarkMode) {
                return {
                    bodyBg: 'rgb(27,27,30)',
                    bodyColor: '#e0e0e0',
                    plotBg: 'rgb(27,27,30)', // Changed to match bodyBg
                    paperBg: 'rgb(27,27,30)',
                    lineColor: '#444',
                    fontColor: '#e0e0e0'
                };
            } else {
                return {
                    bodyBg: '#ffffff',
                    bodyColor: '#1a1a1a',
                    plotBg: '#f8f9fa',
                    paperBg: '#ffffff',
                    lineColor: '#ddd',
                    fontColor: '#1a1a1a'
                };
            }
        };

        // Function to render or re-render the plots
        const renderPlots = () => {
            const { bodyBg, bodyColor, plotBg, paperBg, lineColor, fontColor } = getThemeColors();

            // Apply body and text colors
            document.body.style.backgroundColor = bodyBg;
            document.body.style.color = bodyColor;
            document.querySelectorAll('h1, h2').forEach(el => el.style.color = fontColor);

            // --- Plot 1: Original Data ---
            const data1 = [{
                x: trunk_diameter_cm,
                y: height_m,
                mode: 'lines+markers',
                name: 'Tree Growth Data',
                line: {
                    color: '#1f77b4',
                    width: 3
                },
                marker: {
                    color: '#ff7f0e',
                    size: 10
                }
            }];

            const layout1 = {
                title: {
                    text: 'Original Data',
                    font: { color: fontColor }
                },
                xaxis: {
                    title: 'Trunk Diameter (cm)',
                    zerolinecolor: lineColor,
                    gridcolor: lineColor,
                    tickfont: { color: fontColor },
                    titlefont: { color: fontColor }
                },
                yaxis: {
                    title: 'Height (m)',
                    zerolinecolor: lineColor,
                    gridcolor: lineColor,
                    tickfont: { color: fontColor },
                    titlefont: { color: fontColor }
                },
                plot_bgcolor: plotBg,
                paper_bgcolor: paperBg,
                font: { color: fontColor },
                hovermode: 'closest'
            };
            Plotly.newPlot('myDiv', data1, layout1);

            // --- Plot 2: Centered Data ---
            const mean_x = trunk_diameter_cm.reduce((sum, val) => sum + val, 0) / trunk_diameter_cm.length;
            const mean_y = height_m.reduce((sum, val) => sum + val, 0) / height_m.length;

            const centered_diameter = trunk_diameter_cm.map(val => val - mean_x);
            const centered_height = height_m.map(val => val - mean_y);

            const data2 = [{
                x: centered_diameter,
                y: centered_height,
                mode: 'lines+markers',
                name: 'Centered Tree Growth Data',
                line: {
                    color: '#1f77b4', // Same blue as the first graph
                    width: 3
                },
                marker: {
                    color: '#ff7f0e', // Same orange as the first graph
                    size: 10
                }
            }];

            const layout2 = {
                title: {
                    text: 'Centered Data',
                    font: { color: fontColor }
                },
                xaxis: {
                    title: 'Centered Trunk Diameter (cm)',
                    zerolinecolor: lineColor,
                    gridcolor: lineColor,
                    tickfont: { color: fontColor },
                    titlefont: { color: fontColor }
                },
                yaxis: {
                    title: 'Centered Height (m)',
                    zerolinecolor: lineColor,
                    gridcolor: lineColor,
                    tickfont: { color: fontColor },
                    titlefont: { color: fontColor }
                },
                plot_bgcolor: plotBg,
                paper_bgcolor: paperBg,
                font: { color: fontColor },
                hovermode: 'closest'
            };
            Plotly.newPlot('myDiv2', data2, layout2);
        };

        // Initial render on page load
        window.onload = renderPlots;

        // Add a listener for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', renderPlots);
    </script>
</body>
</html>

